USE jxsk 
//001
DECLARE @SUM SMALLINT,
@I SMALLINT,@NUMS SMALLINT
SET @SUM=0
SET @I = 1
SET @NUMS=0
WHILE (@I<=100)
BEGIN
	IF(@I%3=0)
	BEGIN
		SET @SUM=@SUM+@I
		SET @NUMS=@NUMS+1
	END
	SET @I=@I+1
END
PRINT '总和是'+ STR(@SUM)
PRINT '个数是'+STR(@NUMS)
//002
SELECT SNO AS 学号, SN AS 姓名,性别 =
CASE SEX
WHEN '男' THEN 'M'
WHEN '女' THEN 'W'
END
FROM S
//003
SELECT SN AS 姓名,
	CN AS 课程名,
	成绩 = 
		CASE
		 WHEN SCORE IS NULL THEN '未考 '
		 WHEN SCORE < 60  THEN ' 不及格'
		 WHEN SCORE >=60 AND SCORE<70  THEN ' 及格'
		 WHEN SCORE >= 70AND SCORE<80  THEN ' 中'
		 WHEN SCORE >=80 AND SCORE<90  THEN '良好 '
		 WHEN SCORE >= 90  THEN '优'
		END
FROM SC ,S , C
WHERE S.sno=SC.SNO AND C.CNO = SC.CNO
ORDER BY S.SNO , C.CNO , 
CN ASC   //SN ASC ||SCORE DESC
//004
update T SET SAL =SAL +
CASE 
WHEN T.TNO IN
(SELECT TC.TNO
FROM T,TC
WHERE T.TNO =TC.TNO AND (SAL+COMM)>= 4000
GROUP BY TC.TNO HAVING COUNT(CNO)>=2
) THEN 300

WHEN T.tno IN
(SELECT TC.TNO
FROM T,TC
WHERE T.TNO =TC.TNO AND (SAL+COMM)>= 3000 AND (SAL+COMM)<4000
GROUP BY TC.TNO HAVING COUNT(CNO)>=2
) THEN 200

WHEN T.tno IN
(SELECT TC.TNO
FROM T,TC
WHERE T.TNO =TC.TNO AND (T.SAL+T.COMM< 3000)
GROUP BY TC.TNO HAVING COUNT(CNO)>=2
) THEN 100

WHEN T.tno IN
(SELECT TC.TNO
FROM T,TC
GROUP BY TC.TNO HAVING COUNT(*)=1
)THEN 50
END
SELECT * FROM T 
